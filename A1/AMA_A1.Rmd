---
title: "Density Estimation"
author: "Biel Caballero, Menzenbach Svenja and Reyes Illescas Kleber Enrique"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


#1



#2
```{r CDrate}
cdrate.df <-read.table("../cdrate.dat.txt")
head(cdrate.df)
x <- cdrate.df[,1]
# sort(CDrate)
# # Stem-and-Leaf plot
# stem(CDrate)
```


```{r}
A <- min(x)-.05*diff(range(x)) 
Z <- max(x)+.05*diff(range(x))
nbr <- 7
hx <- hist(x,breaks=seq(A,Z,length=nbr+1),freq=F)
hx_f <- stepfun(hx$breaks,c(0,hx$density,0))
points(x, hx_f(x))

```

#3
```{r}
hx_f2<-length(x)/(length(x)-1)*hx_f(x)-1/((length(x)-1)*(hx$breaks[2]-hx$breaks[1]))

A <- min(x)-.05*diff(range(x)) 
Z <- max(x)+.05*diff(range(x))
nbr <- 7
hx <- hist(x,breaks=seq(A,Z,length=nbr+1),freq=F)
hx_f <- stepfun(hx$breaks,c(0,hx$density,0))
points(x, hx_f(x))
points(x, hx_f2, col="red")
```


#4
```{r}
#sum of the product of the hx_f2 vector plot histograms for different number of breaks nbr

for (i in c(1:15)){
  A <- min(hx_f2)-.05*diff(range(hx_f2)) 
  Z <- max(hx_f2)+.05*diff(range(hx_f2))
  nbr <- i
  hist(hx_f2,breaks=seq(A,Z,length=nbr+1),freq=F)
}
```




































